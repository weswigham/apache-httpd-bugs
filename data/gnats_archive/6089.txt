Received: (qmail 14591 invoked by uid 501); 16 May 2000 08:30:48 -0000
Message-Id: <20000516083048.14589.qmail@locus.apache.org>
Date: 16 May 2000 08:30:48 -0000
From: wolfgang kohl <kohl@gemse.fr>
Reply-To: kohl@gemse.fr
To: submit@bugz.apache.org
Subject: compile with PHP activation fails with LD error
X-Send-Pr-Version: 3.110

>Number:         6089
>Category:       config
>Synopsis:       compile with PHP activation fails with LD error
>Confidential:   no
>Severity:       non-critical
>Priority:       medium
>Responsible:    apache
>State:          open
>Class:          sw-bug
>Submitter-Id:   apache
>Arrival-Date:   Tue May 16 01:40:00 PDT 2000
>Closed-Date:
>Last-Modified:
>Originator:     kohl@gemse.fr
>Release:        1.3.12
>Organization:
apache
>Environment:
sparc/solaris 2.8
GCC 2.95.2
GNU make ( all GNU apps from sunfreeware.com)
PATH:/usr/local/bin
only ld is solaris 2.8 (/usr/css/bin )
>Description:

1) apache_1.3.12 installed, works
2) activation PHP module ( php compiled with mysql, ldap, ftp, gd, ...)
    ./configure --activate-module=src/modules/php3/libphp3.a
    make
    make install
--> results in ld error of un resolved refs
gcc -c  -I./os/unix -I./include   -DSOLARIS2=280 -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDED `./apaci` modules.c
gcc -c  -I./os/unix -I./include   -DSOLARIS2=280 -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDED `./apaci` buildmark.c
gcc  -DSOLARIS2=280 -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDED `./apaci`    \
      -o httpd buildmark.o modules.o modules/standard/libstandard.a modules/php3/libphp3.a main/libmain.a ./os/unix/libos.a ap/liba
p.a regex/libregex.a lib/expat-lite/libexpat.a  -R/usr/local/mysql/lib/mysql  -lz -L/usr/local/mysql/lib/mysql -Lmodules/php3 -L../
modules/php3 -L../../modules/php3 -lmodphp3                        -lpam -lm -ldl -lsocket -lnsl  -lresolv  -lsocket -lnsl -lgdbm
Undefined                       first referenced
 symbol                             in file
gdImageRectangle                    modules/php3/libphp3.a(gd.o)
gdImageLine                         modules/php3/libphp3.a(gd.o)
gdImageColorAllocate                modules/php3/libphp3.a(gd.o)
mysql_get_client_info               modules/php3/libphp3.a(mysql.o)
ldap_count_values_len               modules/php3/libphp3.a(ldap.o)
gdImageSetPixel                     modules/php3/libphp3.a(gd.o)
mysql_drop_db                       modules/php3/libphp3.a(mysql.o)
gdImageBoundsSafe                   modules/php3/libphp3.a(gd.o)
gdImageColorDeallocate              modules/php3/libphp3.a(gd.o)
ldap_get_dn                         modules/php3/libphp3.a(ldap.o)
gdImageFilledPolygon                modules/php3/libphp3.a(gd.o)
ldap_err2string                     modules/php3/libphp3.a(ldap.o)
mysql_close                         modules/php3/libphp3.a(mysql.o)
gdImageFilledRectangle              modules/php3/libphp3.a(gd.o)
mysql_fetch_lengths                 modules/php3/libphp3.a(mysql.o)
ldap_delete_s                       modules/php3/libphp3.a(ldap.o)
gdFontGiant                         modules/php3/libphp3.a(gd.o)
mysql_free_result                   modules/php3/libphp3.a(mysql.o)
ldap_first_entry                    modules/php3/libphp3.a(ldap.o)
......
ldap_dn2ufn                         modules/php3/libphp3.a(ldap.o)
ldap_next_entry                     modules/php3/libphp3.a(ldap.o)
gdImageChar                         modules/php3/libphp3.a(gd.o)
ldap_get_values                     modules/php3/libphp3.a(ldap.o)
mysql_init                          modules/php3/libphp3.a(mysql.o)
ldap_count_entries                  modules/php3/libphp3.a(ldap.o)
ld: fatal: Symbol referencing errors. No output written to httpd
collect2: ld returned 1 exit status
make[2]: *** [target_static] Error 1
make[2]: Leaving directory `/export/home1/descartes/programs/apache_1.3.12/src'
make[1]: *** [build-std] Error 2
make[1]: Leaving directory `/export/home1/descartes/programs/apache_1.3.12'
make: *** [build] Error 2

>How-To-Repeat:

>Fix:
---- this is the LIBS1 generated by configure
#LIBS1=  -R/usr/local/mysql/lib/mysql  -lz -L/usr/local/mysql/lib/mysql -Lmodules/php3 -L../modules/php3 -L../../modules/php3 -lmod
php3                        -lpam -lm -ldl -lsocket -lnsl  -lresolv  -lsocket -lnsl -lgdbm
--- This is the hand corrected LIBS1 which runs OK
LIBS1= -Lmodules/php3 -L../modules/php3 -L../../modules/php3 -lmodphp3   -R/usr/local/mysql/lib/mysql -L/usr/local/mysql/lib/mysql
-lmysqlclient -lpng  -lldap -llber -lgd -lgdbm  -lm -ldl -lsocket -lnsl  -lresolv  -lsocket -lnsl
>Release-Note:
>Audit-Trail:
>Unformatted:
 [In order for any reply to be added to the PR database, you need]
 [to include <apbugs@Apache.Org> in the Cc line and make sure the]
 [subject line starts with the report component and number, with ]
 [or without any 'Re:' prefixes (such as "general/1098:" or      ]
 ["Re: general/1098:").  If the subject doesn't match this       ]
 [pattern, your message will be misfiled and ignored.  The       ]
 ["apbugs" address is not added to the Cc line of messages from  ]
 [the database automatically because of the potential for mail   ]
 [loops.  If you do not include this Cc, your reply may be ig-   ]
 [nored unless you are responding to an explicit request from a  ]
 [developer.  Reply only with text; DO NOT SEND ATTACHMENTS!     ]
 
 

